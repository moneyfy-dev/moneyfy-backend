- name: Deploy to server
  uses: appleboy/scp-action@v0.1.7
  with:
    host: ${{ secrets.SERVER_HOST }}
    username: ${{ secrets.SERVER_USER }}
    key: ${{ secrets.SERVER_SSH_KEY }}
    port: ${{ secrets.SERVER_PORT }}
    source: "target/*.war"
    target: "/tmp/app.war"

- name: Restart Tomcat
  uses: appleboy/ssh-action@v0.1.10
  with:
    host: ${{ secrets.SERVER_HOST }}
    username: ${{ secrets.SERVER_USER }}
    key: ${{ secrets.SERVER_SSH_KEY }}
    port: ${{ secrets.SERVER_PORT }}
    script: |
      TOMCAT_WEBAPPS="/opt/tomcat10/webapps"
      mv /tmp/app.war $TOMCAT_WEBAPPS/ROOT.war
      systemctl restart tomcat10